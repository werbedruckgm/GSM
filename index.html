<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Werbetechniker-Tools | GR√ñNER-SCHULZE GMBH</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --brand-navy: #0E1D3A; --brand-cyan: #1DA1F2; --bg-page: #f0f2f5; --app-width: 360px;
        }
        html, body { 
            height: 100%; margin: 0; background: var(--bg-page); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; 
        }
        .app-shell {
            width: var(--app-width); min-width: var(--app-width); background: var(--brand-navy);
            color: white; box-shadow: 0 20px 50px rgba(0,0,0,0.3); border-radius: 30px;
            overflow: hidden; display: flex; flex-direction: column; margin: 10px;
            position: relative; height: 760px;
        }
        @media (max-width: 380px) { .app-shell { width: 100vw; height: 100vh; border-radius: 0; margin: 0; } }
        
        #egg-popup { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(14, 29, 58, 0.95); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(4px); }
        .egg-content { background: var(--brand-navy); border: 2px solid var(--brand-cyan); padding: 30px 20px; border-radius: 20px; text-align: center; width: 80%; }

        .view { display: none; flex-direction: column; padding: 15px 20px; box-sizing: border-box; height: 100%; overflow-y: auto; }
        .view.active { display: flex; }
        .top-nav { display: flex; justify-content: space-between; padding: 15px 20px 5px; gap: 8px; }
        select { background: white; border: none; padding: 8px; border-radius: 6px; font-weight: bold; font-size: 0.75rem; color: var(--brand-navy); outline: none; width: 100%; margin-bottom: 10px; }
        
        .logo-area { text-align: center; padding: 5px 0 10px; }
        .logo-area img { max-width: 130px; height: auto; cursor: pointer; }
        .logo-area h1 { font-size: 0.85rem; letter-spacing: 1.5px; margin: 5px 0; font-weight: 800; }
        
        .card { background: white; border-radius: 15px; padding: 10px; display: flex; align-items: center; gap: 12px; cursor: pointer; color: var(--brand-navy); margin-bottom: 12px; }
        .icon { width: 38px; height: 38px; background: var(--brand-navy); color: var(--brand-cyan); border-radius: 10px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        
        .input-box { margin-bottom: 8px; }
        .label { font-size: 0.6rem; color: var(--brand-cyan); font-weight: 800; text-transform: uppercase; margin-bottom: 3px; display: block; }
        input { width: 100%; padding: 10px; border-radius: 8px; border: 1px solid transparent; font-size: 0.9rem; font-weight: bold; color: var(--brand-navy); box-sizing: border-box; outline: none; }
        
        .res-card { background: white; padding: 12px; border-radius: 18px; text-align: center; margin: 8px 0; color: var(--brand-navy); }
        .res-num { font-size: 1.8rem; font-weight: 900; color: var(--brand-cyan); display: block; }
        .res-info { font-size: 0.6rem; color: #718096; font-weight: bold; display: block; }
        
        .action-btn { background: #ff9900; color: black; border: none; padding: 10px; border-radius: 12px; font-size: 0.7rem; font-weight: 800; cursor: pointer; margin-top: 10px; display: flex; align-items: center; justify-content: center; gap: 5px; width: 100%; text-transform: uppercase; }
        .list-btn { background: var(--brand-cyan); color: white; }
        .wa-btn { background: #25D366; color: white; }
        .hist-btn { background: #64748b; color: white; }
        
        .spec-box { background: rgba(255,255,255,0.05); padding: 12px; border-radius: 15px; font-size: 0.75rem; border: 1px solid rgba(29, 161, 242, 0.3); margin-top: 10px; }
        .spec-line { display: flex; justify-content: space-between; margin-bottom: 4px; border-bottom: 1px solid rgba(255,255,255,0.1); padding-bottom: 2px; }
        
        .back-btn { color: white; display: flex; align-items: center; gap: 4px; cursor: pointer; padding-bottom: 15px; font-weight: bold; font-size: 0.75rem; }
        footer { text-align: center; padding: 15px; font-size: 0.6rem; color: #94a3b8; margin-top: auto; }
        
        .order-list { background: white; color: var(--brand-navy); padding: 15px; border-radius: 15px; font-size: 0.8rem; margin-top: 10px; }
        .order-item { border-bottom: 1px solid #eee; padding: 8px 0; display: flex; justify-content: space-between; }
        .hist-item { background: rgba(255,255,255,0.1); padding: 10px; border-radius: 10px; margin-bottom: 8px; cursor: pointer; }
    </style>
</head>
<body>

<div class="app-shell">
    <div id="egg-popup"><div class="egg-content">Powered by<br><strong>Werbedruck-GM</strong><br>DER MEISTER</div></div>

    <div class="top-nav">
        <select id="uG" style="width: auto;" onchange="updateAllUnits()"><option value="mm">mm</option><option value="inc">inch</option></select>
        <select id="lG" style="width: auto;" onchange="changeLang()"></select>
    </div>

    <div id="main" class="view active">
        <div class="logo-area"><img src="GS-Logo.jpg" id="logo-trigger"><h1 data-t="mainH">Werbetechniker-Tools</h1></div>
        <div class="menu-list">
            <div class="card" onclick="go('rollen')"><div class="icon"><i data-lucide="ruler"></i></div><div class="card-text"><h2>Rollen-Meter</h2><p>L√§ngen berechnen</p></div></div>
            <div class="card" onclick="go('nutzen')"><div class="icon"><i data-lucide="layout-grid"></i></div><div class="card-text"><h2>Nutzen-Optimierer</h2><p>Schnittpl√§ne</p></div></div>
            <div class="card" onclick="go('led')"><div class="icon"><i data-lucide="lightbulb"></i></div><div class="card-text"><h2>LED-Profi</h2><p>Licht-Planung</p></div></div>
            <div class="card" onclick="showHistory()"><div class="icon" style="color:#fbbf24;"><i data-lucide="history"></i></div><div class="card-text"><h2>Historie</h2><p>Gespeicherte Projekte</p></div></div>
        </div>
        <footer id="footer-content"></footer>
    </div>

    <div id="view-led" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span>ZUR√úCK</span></div>
        <div class="logo-area"><h1>LED-Rechner</h1></div>
        <div class="input-box"><span class="label">Projektname</span><input type="text" id="projName" placeholder="Kunde / Auftrag"></div>
        <div class="sub-grid" style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">
            <div class="input-box"><span class="label">Breite (mm)</span><input type="number" id="lkw" value="1000" oninput="calcL()"></div>
            <div class="input-box"><span class="label">H√∂he (mm)</span><input type="number" id="lkh" value="500" oninput="calcL()"></div>
        </div>
        <div class="input-box"><span class="label">Tiefe (mm)</span><input type="number" id="lz" value="100" oninput="calcL()"></div>

        <select id="lSelect" onchange="applyModule()">
            <optgroup label="GS Professional"><option value="gs_eco">GS-Eco 0.72W</option><option value="gs_pow">GS-Power 1.20W</option></optgroup>
            <optgroup label="Amazon Bestseller"><option value="amz_std">AMZ Standard 0.72W</option><option value="amz_inj">AMZ Inject 1.50W</option></optgroup>
        </select>

        <div class="res-card"><span class="res-info">MAX. ABSTAND</span><span id="resL" class="res-num">0.0 mm</span></div>

        <div class="spec-box" id="led-results">
            <div class="spec-line"><span>Module:</span><span id="outQty" class="spec-val">0</span></div>
            <div class="spec-line"><span>Last:</span><span id="outTW" class="spec-val">0 W</span></div>
            <div class="spec-line"><span>Netzteil:</span><span id="outPSU" class="spec-val">---</span></div>
        </div>

        <button class="action-btn list-btn" onclick="showList()"><i data-lucide="list-checks"></i> Materialliste</button>
        <button class="action-btn hist-btn" onclick="saveToHistory()"><i data-lucide="save"></i> Projekt speichern</button>
    </div>

    <div id="view-liste" class="view">
        <div class="back-btn" onclick="go('led')"><i data-lucide="chevron-left"></i> <span>ZUR√úCK</span></div>
        <div class="logo-area"><h1>Materialliste</h1></div>
        <div class="order-list" id="order-content"></div>
        <button class="action-btn wa-btn" onclick="shareWhatsApp()"><i data-lucide="message-circle"></i> WhatsApp</button>
        <button class="action-btn list-btn" onclick="window.print()"><i data-lucide="printer"></i> PDF</button>
    </div>

    <div id="view-historie" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span>ZUR√úCK</span></div>
        <div class="logo-area"><h1>Letzte Projekte</h1></div>
        <div id="hist-list"></div>
        <button class="action-btn" style="background:#ef4444; color:white;" onclick="clearHistory()">Historie l√∂schen</button>
    </div>
</div>

<script>
    const modules = {
        gs_eco: { name: "GS-Eco 0.72W", a: 160, w: 0.72, src: 'GS' },
        gs_pow: { name: "GS-Power 1.20W", a: 170, w: 1.2, src: 'GS' },
        amz_std: { name: "AMZ Standard 0.72W", a: 120, w: 0.72, src: 'AMZ' },
        amz_inj: { name: "AMZ Inject 1.50W", a: 160, w: 1.5, src: 'AMZ' }
    };

    const psuDatabase = [
        { name: "Netzteil 60W", p: 60, src: 'GS' },
        { name: "Netzteil 150W", p: 150, src: 'GS' },
        { name: "Amazon 120W", p: 120, src: 'AMZ' }
    ];

    function applyModule() { calcL(); }

    function calcL() {
        let kw = parseFloat(document.getElementById('lkw').value), kh = parseFloat(document.getElementById('lkh').value),
            z = parseFloat(document.getElementById('lz').value), sel = document.getElementById('lSelect').value;
        let mod = modules[sel];
        let dist = (2 * z * Math.tan((mod.a/2) * (Math.PI/180)) * 0.6);
        document.getElementById('resL').innerText = dist.toFixed(1) + " mm";
        let q = Math.ceil(kw/dist) * Math.ceil(kh/dist);
        let load = q * mod.w;
        document.getElementById('outQty').innerText = q;
        document.getElementById('outTW').innerText = load.toFixed(1) + " W";
        let psu = psuDatabase.find(p => p.p >= load * 1.2 && (mod.src === p.src));
        document.getElementById('outPSU').innerText = psu ? psu.name : "Split needed";
    }

    /* HISTORIE LOGIK */
    function saveToHistory() {
        let name = document.getElementById('projName').value || "Unbenanntes Projekt";
        let data = {
            name: name,
            date: new Date().toLocaleDateString('de-DE'),
            qty: document.getElementById('outQty').innerText,
            mod: modules[document.getElementById('lSelect').value].name,
            psu: document.getElementById('outPSU').innerText
        };
        let history = JSON.parse(localStorage.getItem('gs_history') || '[]');
        history.unshift(data);
        if(history.length > 10) history.pop();
        localStorage.setItem('gs_history', JSON.stringify(history));
        alert("Projekt gespeichert!");
    }

    function showHistory() {
        let history = JSON.parse(localStorage.getItem('gs_history') || '[]');
        let container = document.getElementById('hist-list');
        container.innerHTML = history.length ? "" : "<p>Keine Eintr√§ge vorhanden.</p>";
        history.forEach((item, index) => {
            container.innerHTML += `
                <div class="hist-item" onclick="loadHistoryItem(${index})">
                    <strong>${item.name}</strong><br>
                    <small>${item.date} | ${item.qty}x ${item.mod}</small>
                </div>`;
        });
        go('historie');
    }

    function clearHistory() { if(confirm("Historie wirklich l√∂schen?")) { localStorage.removeItem('gs_history'); showHistory(); } }

    function showList() {
        let mod = modules[document.getElementById('lSelect').value];
        let qty = document.getElementById('outQty').innerText;
        let psu = document.getElementById('outPSU').innerText;
        document.getElementById('order-content').innerHTML = `
            <div style="font-weight:bold; border-bottom:1px solid #000; margin-bottom:10px;">PROJEKT: LED</div>
            <div class="order-item"><span>${mod.name}</span><strong>${qty} Stk.</strong></div>
            <div class="order-item"><span>${psu}</span><strong>1 Stk.</strong></div>
        `;
        go('liste');
    }

    function shareWhatsApp() {
        let mod = modules[document.getElementById('lSelect').value];
        let text = `*PROJEKT-MATERIAL*\nüì¶ Modul: ${mod.name}\nüî¢ Anzahl: ${document.getElementById('outQty').innerText}\n‚ö° Netzteil: ${document.getElementById('outPSU').innerText}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }

    /* CORE LOGIC */
    function go(v) { 
        document.querySelectorAll('.view').forEach(e => e.classList.remove('active')); 
        document.getElementById(v === 'main' ? 'main' : 'view-' + v).classList.add('active'); 
        lucide.createIcons(); 
    }
    function initApp() { 
        const sel = document.getElementById('lG');
        ["de", "en"].forEach(k => { let o = document.createElement('option'); o.value = k; o.innerText = k.toUpperCase(); sel.appendChild(o); });
        sel.value = "de"; lucide.createIcons(); calcL(); 
    }
    
    let clicks = 0, timer;
    document.getElementById('logo-trigger').addEventListener('click', () => {
        clicks++; clearTimeout(timer);
        if (clicks === 5) { document.getElementById('egg-popup').style.display = 'flex'; setTimeout(() => { document.getElementById('egg-popup').style.display = 'none'; }, 3000); clicks = 0; }
        timer = setTimeout(() => { clicks = 0; }, 1000);
    });

    document.getElementById('footer-content').innerHTML = `<strong>GR√ñNER-SCHULZE GMBH</strong>V2.2.2 | 30.01.2026<br><a href="https://www.groener-schulze.com/impressum" target="_blank">Impressum</a> | <a href="https://www.groener-schulze.com/datenschutzbestimmungen" target="_blank">Datenschutz</a>`;
    initApp();
</script>
</body>
</html>
