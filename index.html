<!DOCTYPE html>
<html lang="de">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>Werbetechniker-Tools | GRÃ–NER-SCHULZE GMBH</title>
    <script src="https://unpkg.com/lucide@latest"></script>
    <style>
        :root {
            --brand-navy: #0E1D3A; --brand-cyan: #1DA1F2; --bg-page: #f0f2f5; --app-width: 360px;
        }
        html, body { 
            height: 100%; margin: 0; padding: 0; background: var(--bg-page); 
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
            display: flex; justify-content: center; align-items: center; 
        }
        .app-shell {
            width: var(--app-width); min-width: var(--app-width); background: var(--brand-navy);
            color: white; box-shadow: 0 20px 50px rgba(0,0,0,0.3); border-radius: 30px;
            overflow: hidden; display: flex; flex-direction: column; margin: 10px;
            position: relative; height: 740px;
        }
        @media (max-width: 380px) { .app-shell { width: 100vw; height: 100vh; border-radius: 0; margin: 0; } }
        
        #egg-popup { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(14, 29, 58, 0.95); display: none; justify-content: center; align-items: center; z-index: 1000; backdrop-filter: blur(4px); }
        .egg-content { background: var(--brand-navy); border: 2px solid var(--brand-cyan); padding: 30px 20px; border-radius: 20px; text-align: center; width: 80%; }

        /* Navigation */
        .view { display: none; flex-direction: column; padding: 12px 18px; box-sizing: border-box; height: 100%; overflow-y: auto; }
        .view.active { display: flex; }
        .top-nav { display: flex; justify-content: space-between; padding: 12px 18px 5px; gap: 8px; }
        select { background: white; border: none; padding: 4px 6px; border-radius: 4px; font-weight: bold; font-size: 0.65rem; color: var(--brand-navy); outline: none; }
        
        .logo-area { text-align: center; padding: 5px 0 8px; }
        .logo-area img { max-width: 110px; height: auto; cursor: pointer; }
        .logo-area h1 { font-size: 0.8rem; letter-spacing: 1px; margin: 3px 0; font-weight: 800; }
        
        /* Compact Buttons */
        .card { background: white; border-radius: 12px; padding: 8px 12px; display: flex; align-items: center; gap: 10px; cursor: pointer; color: var(--brand-navy); margin-bottom: 10px; }
        .icon { width: 32px; height: 32px; background: var(--brand-navy); color: var(--brand-cyan); border-radius: 8px; display: flex; align-items: center; justify-content: center; flex-shrink: 0; }
        .card-text h2 { margin: 0; font-size: 0.85rem; }
        .card-text p { margin: 0; font-size: 0.6rem; color: #64748b; }

        .bt-btn, .action-btn { background: #2563eb; color: white; border: none; padding: 5px 10px; border-radius: 10px; font-size: 0.62rem; font-weight: 800; display: flex; align-items: center; justify-content: center; gap: 5px; cursor: pointer; width: 100%; text-transform: uppercase; margin-bottom: 8px; }
        .back-btn { color: white; display: flex; align-items: center; gap: 4px; cursor: pointer; padding-bottom: 12px; font-weight: bold; font-size: 0.7rem; }

        /* Inputs & Typography */
        .input-box { margin-bottom: 8px; }
        .label { font-size: 0.55rem; color: var(--brand-cyan); font-weight: 800; text-transform: uppercase; margin-bottom: 3px; display: block; }
        input { width: 100%; padding: 8px; border-radius: 6px; border: 1px solid transparent; font-size: 0.85rem; font-weight: bold; color: var(--brand-navy); box-sizing: border-box; outline: none; }
        
        .res-card { background: white; padding: 10px; border-radius: 15px; text-align: center; margin: 6px 0; color: var(--brand-navy); }
        .res-num { font-size: 1.6rem; font-weight: 900; color: var(--brand-cyan); display: block; }
        .res-info { font-size: 0.55rem; color: #718096; font-weight: bold; display: block; }
        
        .spec-box { background: rgba(255,255,255,0.05); padding: 10px; border-radius: 12px; font-size: 0.7rem; border: 1px solid rgba(29, 161, 242, 0.2); }
        .spec-line { display: flex; justify-content: space-between; margin-bottom: 3px; border-bottom: 1px solid rgba(255,255,255,0.05); padding-bottom: 2px; }

        footer { text-align: center; padding: 12px; font-size: 0.55rem; color: #94a3b8; margin-top: auto; }
        .footer-links a { color: #94a3b8; text-decoration: none; margin: 0 4px; }
        .hist-item { background: rgba(255,255,255,0.1); padding: 8px; border-radius: 8px; margin-bottom: 6px; cursor: pointer; font-size: 0.7rem; }
    </style>
</head>
<body>

<div class="app-shell">
    <div id="egg-popup"><div class="egg-content">Powered by<br><strong>Werbedruck-GM</strong><br>DER MEISTER</div></div>

    <div class="top-nav">
        <select id="uG" onchange="updateAllUnits()"><option value="mm">mm</option><option value="inc">inch</option></select>
        <select id="lG" onchange="changeLang()">
            <option value="de">DE</option><option value="en">EN</option><option value="fr">FR</option>
            <option value="es">ES</option><option value="it">IT</option><option value="nl">NL</option>
            <option value="pl">PL</option><option value="ru">RU</option><option value="da">DA</option>
            <option value="no">NO</option><option value="ja">JP</option>
        </select>
    </div>

    <div id="main" class="view active">
        <div class="logo-area"><img src="GS-Logo.jpg" id="logo-trigger"><h1 data-t="mainH">Werbetechniker-Tools</h1></div>
        <div class="menu-list">
            <div class="card" onclick="go('rollen')"><div class="icon"><i data-lucide="ruler"></i></div><div class="card-text"><h2 data-t="r_h">Rollen-Meter</h2><p data-t="r_p">LÃ¤ngen berechnen</p></div></div>
            <div class="card" onclick="go('nutzen')"><div class="icon"><i data-lucide="layout-grid"></i></div><div class="card-text"><h2 data-t="n_h">Nutzen-Optimierer</h2><p data-t="n_p">SchnittplÃ¤ne</p></div></div>
            <div class="card" onclick="go('led')"><div class="icon"><i data-lucide="lightbulb"></i></div><div class="card-text"><h2 data-t="l_h">LED-Profi</h2><p data-t="l_p">Licht-Planung</p></div></div>
            <div class="card" onclick="showHistory()"><div class="icon" style="color:#fbbf24;"><i data-lucide="history"></i></div><div class="card-text"><h2 data-t="hist">Historie</h2><p data-t="hist_p">Gespeicherte Projekte</p></div></div>
        </div>
        <footer id="footer-content"></footer>
    </div>

    <div id="view-rollen" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span data-t="back">ZURÃœCK</span></div>
        <div class="logo-area"><h1 data-t="r_h">Rollen-Meter</h1></div>
        <button class="bt-btn" onclick="alert('BT Search...')"><i data-lucide="bluetooth"></i> <span data-t="bt">BT-Verbinden</span></button>
        <div class="input-box"><span class="label" data-t="r_d1">Durchmesser (D)</span><input type="number" id="rD" value="150" oninput="calcR()"></div>
        <div class="input-box"><span class="label" data-t="r_d2">Kern (d)</span><input type="number" id="rd" value="76" oninput="calcR()"></div>
        <div class="input-box"><span class="label" data-t="r_s">StÃ¤rke (mm)</span><input type="number" id="rs" value="0.15" step="0.01" oninput="calcR()"></div>
        <div class="res-card"><span id="resR" class="res-num">0.00 m</span><span class="res-info" data-t="res_l">LÃ„NGE</span></div>
    </div>

    <div id="view-nutzen" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span data-t="back">ZURÃœCK</span></div>
        <div class="logo-area"><h1 data-t="n_h">Nutzen-Rechner</h1></div>
        <div style="display:flex; gap:8px;">
            <div class="input-box" style="flex:1;"><span class="label" data-t="n_pb">Platte B</span><input type="number" id="pW" value="3000" oninput="calcN()"></div>
            <div class="input-box" style="flex:1;"><span class="label" data-t="n_ph">Platte H</span><input type="number" id="pH" value="1500" oninput="calcN()"></div>
        </div>
        <div class="input-box"><span class="label" data-t="n_cut">Schnittbreite</span><input type="number" id="cut" value="0" step="0.5" oninput="calcN()" style="background:rgba(29,161,242,0.1)"></div>
        <div style="display:flex; gap:8px;">
            <div class="input-box" style="flex:1;"><span class="label" data-t="n_sb">Schild B</span><input type="number" id="sW" placeholder="600" oninput="calcN()"></div>
            <div class="input-box" style="flex:1;"><span class="label" data-t="n_sh">Schild H</span><input type="number" id="sH" placeholder="400" oninput="calcN()"></div>
        </div>
        <div class="res-card"><span id="resN" class="res-num">0</span><span id="resE" class="res-info" data-t="eff">Effizienz: 0%</span></div>
    </div>

    <div id="view-led" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span data-t="back">ZURÃœCK</span></div>
        <div class="input-box"><span class="label" data-t="proj">Projektname</span><input type="text" id="projName" data-p="proj_p"></div>
        <div style="display:grid; grid-template-columns:1fr 1fr; gap:8px;">
            <div class="input-box"><span class="label" data-t="n_pb">Breite</span><input type="number" id="lkw" value="1200" oninput="calcL()"></div>
            <div class="input-box"><span class="label" data-t="n_ph">HÃ¶he</span><input type="number" id="lkh" value="600" oninput="calcL()"></div>
        </div>
        <div class="input-box"><span class="label" data-t="l_z">Tiefe (Z)</span><input type="number" id="lz" value="100" oninput="calcL()"></div>
        <select id="lSelect" onchange="applyModule()">
            <option value="gs_eco">GS-Eco 0.72W</option><option value="gs_pow">GS-Power 1.20W</option>
            <option value="amz_std">AMZ Std 0.72W</option><option value="amz_inj">AMZ Inj 1.50W</option>
        </select>
        <div class="res-card"><span class="res-info" data-t="l_res">ABSTAND</span><span id="resL" class="res-num">0.0 mm</span></div>
        <div class="spec-box">
            <div class="spec-line"><span data-t="l_qty">Module</span><span id="outQty">0</span></div>
            <div class="spec-line"><span data-t="l_psu">Netzteil</span><span id="outPSU">---</span></div>
        </div>
        <button class="action-btn" style="background:var(--brand-cyan); color:white; margin-top:10px;" onclick="showList()"><i data-lucide="list"></i> <span data-t="list_btn">Materialliste</span></button>
        <button class="action-btn" style="background:#64748b; color:white;" onclick="saveToHistory()"><i data-lucide="save"></i> <span data-t="save_btn">Speichern</span></button>
    </div>

    <div id="view-liste" class="view">
        <div class="back-btn" onclick="go('led')"><i data-lucide="chevron-left"></i> <span data-t="back">ZURÃœCK</span></div>
        <div id="order-content" class="order-list" style="background:white; color:#0e1d3a; padding:15px; border-radius:15px; font-size:0.75rem;"></div>
        <button class="action-btn" style="background:#25D366; color:white; margin-top:12px;" onclick="shareWhatsApp()"><i data-lucide="message-circle"></i> WhatsApp</button>
    </div>

    <div id="view-historie" class="view">
        <div class="back-btn" onclick="go('main')"><i data-lucide="chevron-left"></i> <span data-t="back">ZURÃœCK</span></div>
        <div id="hist-list"></div>
        <button class="action-btn" style="background:#ef4444; color:white;" onclick="clearHistory()" data-t="clear_hist">LÃ¶schen</button>
    </div>
</div>

<script>
    const i18n = {
        de: { mainH: "Werbetechniker-Tools", back: "ZURÃœCK", bt: "BT-Verbinden", r_h: "Rollen-Meter", r_p: "LÃ¤ngen berechnen", r_d1: "Durchmesser (D)", r_d2: "Kern (d)", r_s: "StÃ¤rke (mm)", res_l: "LÃ„NGE", n_h: "Nutzen-Rechner", n_p: "SchnittplÃ¤ne", n_pb: "Platte B", n_ph: "Platte H", n_cut: "Schnittbreite", n_sb: "Schild B", n_sh: "Schild H", eff: "Effizienz", l_h: "LED-Profi", l_p: "Planung", l_z: "Tiefe (Z)", l_res: "ABSTAND", l_qty: "Module", l_psu: "Netzteil", hist: "Historie", hist_p: "Projekte", proj: "Projektname", proj_p: "Kunde...", save_btn: "Speichern", list_btn: "Liste", clear_hist: "LÃ¶schen", imp: "Impressum", priv: "Datenschutz" },
        en: { mainH: "Signmaker Tools", back: "BACK", bt: "BT-Connect", r_h: "Roll Meter", r_p: "Calculate", r_d1: "Diameter (D)", r_d2: "Core (d)", r_s: "Thickness", res_l: "LENGTH", n_h: "Nesting", n_p: "Layouts", n_pb: "Sheet W", n_ph: "Sheet H", n_cut: "Cut Width", n_sb: "Sign W", n_sh: "Sign H", eff: "Efficiency", l_h: "LED Pro", l_p: "Planning", l_z: "Depth (Z)", l_res: "SPACING", l_qty: "Modules", l_psu: "PSU", hist: "History", hist_p: "Projects", proj: "Project", proj_p: "Customer...", save_btn: "Save", list_btn: "List", clear_hist: "Clear", imp: "Legal", priv: "Privacy" },
        fr: { mainH: "Outils SignalÃ©tique", back: "RETOUR", bt: "Connexion BT", r_h: "MÃ¨tre de Rouleau", r_p: "Calculer", r_d1: "DiamÃ¨tre (D)", r_d2: "Noyau (d)", r_s: "Ã‰paisseur", res_l: "LONGUEUR", n_h: "Optimiseur", n_p: "Mises en page", n_pb: "Largeur", n_ph: "Hauteur", n_cut: "Coupe", n_sb: "Panneau B", n_sh: "Panneau H", eff: "EfficacitÃ©", l_h: "LED Pro", l_p: "Plan", l_z: "Profondeur", l_res: "DISTANCE", l_qty: "Modules", l_psu: "Alim.", hist: "Historique", hist_p: "Projets", proj: "Nom", proj_p: "Client...", save_btn: "Sauver", list_btn: "Liste", clear_hist: "Effacer", imp: "Mentions", priv: "ConfidentialitÃ©" },
        es: { mainH: "Herramientas de RÃ³tulo", back: "VOLVER", bt: "ConexiÃ³n BT", r_h: "Metro de Rollo", r_p: "Calcular", r_d1: "DiÃ¡metro (D)", r_d2: "NÃºcleo (d)", r_s: "Espesor", res_l: "LONGITUD", n_h: "Optimizador", n_p: "DiseÃ±os", n_pb: "Ancho", n_ph: "Alto", n_cut: "Corte", n_sb: "Cartel B", n_sh: "Cartel H", eff: "Eficiencia", l_h: "LED Pro", l_p: "Plan", l_z: "Profundidad", l_res: "DISTANCIA", l_qty: "MÃ³dulos", l_psu: "Fuente", hist: "Historial", hist_p: "Proyectos", proj: "Proyecto", proj_p: "Cliente...", save_btn: "Guardar", list_btn: "Lista", clear_hist: "Borrar", imp: "Aviso", priv: "Privacidad" },
        it: { mainH: "Strumenti Insegne", back: "INDIETRO", bt: "Connetti BT", r_h: "Metro a Rullo", r_p: "Calcola", r_d1: "Diametro (D)", r_d2: "Anima (d)", r_s: "Spessore", res_l: "LUNGHEZZA", n_h: "Ottimizzatore", n_p: "Layout", n_pb: "Lastra L", n_ph: "Lastra A", n_cut: "Taglio", n_sb: "Insegna L", n_sh: "Insegna A", eff: "Efficienza", l_h: "LED Pro", l_p: "Pianifica", l_z: "ProfonditÃ ", l_res: "DISTANZA", l_qty: "Moduli", l_psu: "Alimentatore", hist: "Cronologia", hist_p: "Progetti", proj: "Progetto", proj_p: "Cliente...", save_btn: "Salva", list_btn: "Lista", clear_hist: "Cancella", imp: "Note", priv: "Privacy" },
        nl: { mainH: "Signmaker Tools", back: "TERUG", bt: "BT-Verbinden", r_h: "Rolmeter", r_p: "Berekenen", r_d1: "Diameter (D)", r_d2: "Kern (d)", r_s: "Dikte", res_l: "LENGTE", n_h: "Optimalisator", n_p: "Layouts", n_pb: "Plaat B", n_ph: "Plaat H", n_cut: "Snijbreedte", n_sb: "Bord B", n_sh: "Bord H", eff: "Efficiency", l_h: "LED Pro", l_p: "Planning", l_z: "Diepte", l_res: "AFSTAND", l_qty: "Modules", l_psu: "Voeding", hist: "Historie", hist_p: "Projecten", proj: "Project", proj_p: "Klant...", save_btn: "Opslaan", list_btn: "Lijst", clear_hist: "Wissen", imp: "Colofon", priv: "Privacy" },
        pl: { mainH: "NarzÄ™dzia Reklamowe", back: "POWRÃ“T", bt: "PoÅ‚Ä…cz BT", r_h: "Miernik Rolek", r_p: "Oblicz", r_d1: "Åšrednica (D)", r_d2: "RdzeÅ„ (d)", r_s: "GruboÅ›Ä‡", res_l: "DÅUGOÅšÄ†", n_h: "Optymalizator", n_p: "UkÅ‚ady", n_pb: "PÅ‚yta S", n_ph: "PÅ‚yta W", n_cut: "SzerokoÅ›Ä‡ ciÄ™cia", n_sb: "Szyld S", n_sh: "Szyld W", eff: "WydajnoÅ›Ä‡", l_h: "LED Pro", l_p: "Planowanie", l_z: "GÅ‚Ä™bokoÅ›Ä‡", l_res: "DYSTANS", l_qty: "ModuÅ‚y", l_psu: "Zasilacz", hist: "Historia", hist_p: "Projekty", proj: "Projekt", proj_p: "Klient...", save_btn: "Zapisz", list_btn: "Lista", clear_hist: "UsuÅ„", imp: "Nota", priv: "PrywatnoÅ›Ä‡" },
        ru: { mainH: "Ð˜Ð½ÑÑ‚Ñ€ÑƒÐ¼ÐµÐ½Ñ‚Ñ‹", back: "ÐÐÐ—ÐÐ”", bt: "BT-Ð¡Ð²ÑÐ·ÑŒ", r_h: "Ð ÑƒÐ»Ð¾Ð½Ð½Ñ‹Ð¹ Ð¼ÐµÑ‚Ñ€", r_p: "Ð Ð°ÑÑ‡ÐµÑ‚", r_d1: "Ð”Ð¸Ð°Ð¼ÐµÑ‚Ñ€ (D)", r_d2: "Ð’Ñ‚ÑƒÐ»ÐºÐ° (d)", r_s: "Ð¢Ð¾Ð»Ñ‰Ð¸Ð½Ð°", res_l: "Ð”Ð›Ð˜ÐÐ", n_h: "Ð Ð°ÑÐºÑ€Ð¾Ð¹", n_p: "ÐœÐ°ÐºÐµÑ‚Ñ‹", n_pb: "Ð›Ð¸ÑÑ‚ Ð¨", n_ph: "Ð›Ð¸ÑÑ‚ Ð’", n_cut: "Ð ÐµÐ·", n_sb: "Ð’Ñ‹Ð²ÐµÑÐºÐ° Ð¨", n_sh: "Ð’Ñ‹Ð²ÐµÑÐºÐ° Ð’", eff: "Ð­Ñ„Ñ„ÐµÐºÑ‚.", l_h: "LED ÐŸÑ€Ð¾Ñ„Ð¸", l_p: "ÐŸÐ»Ð°Ð½Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ", l_z: "Ð“Ð»ÑƒÐ±Ð¸Ð½Ð°", l_res: "Ð˜ÐÐ¢Ð•Ð Ð’ÐÐ›", l_qty: "ÐœÐ¾Ð´ÑƒÐ»Ð¸", l_psu: "Ð‘Ð»Ð¾Ðº", hist: "Ð˜ÑÑ‚Ð¾Ñ€Ð¸Ñ", hist_p: "ÐŸÑ€Ð¾ÐµÐºÑ‚Ñ‹", proj: "ÐŸÑ€Ð¾ÐµÐºÑ‚", proj_p: "ÐšÐ»Ð¸ÐµÐ½Ñ‚...", save_btn: "Ð¡Ð¾Ñ…Ñ€Ð°Ð½Ð¸Ñ‚ÑŒ", list_btn: "Ð¡Ð¿Ð¸ÑÐ¾Ðº", clear_hist: "Ð£Ð´Ð°Ð»Ð¸Ñ‚ÑŒ", imp: "ÐšÐ¾Ð½Ñ‚Ð°ÐºÑ‚Ñ‹", priv: "Ð”Ð°Ð½Ð½Ñ‹Ðµ" },
        da: { mainH: "Skiltetekniker", back: "TILBAGE", bt: "BT-Forbind", r_h: "Rulle-meter", r_p: "Beregn", r_d1: "Diameter (D)", r_d2: "Kerne (d)", r_s: "Tykkelse", res_l: "LÃ†NGDE", n_h: "Optimering", n_p: "Layouts", n_pb: "Plade B", n_ph: "Plade H", n_cut: "SkÃ¦rebredde", n_sb: "Skilt B", n_sh: "Skilt H", eff: "Effektivitet", l_h: "LED Pro", l_p: "Plan", l_z: "Dybde", l_res: "AFSTAND", l_qty: "Moduler", l_psu: "StrÃ¸m", hist: "Historik", hist_p: "Projekter", proj: "Projekt", proj_p: "Kunde...", save_btn: "Gem", list_btn: "Liste", clear_hist: "Slet", imp: "Impressum", priv: "Privatliv" },
        no: { mainH: "Skiltmaker", back: "TILBAKE", bt: "BT-Koble", r_h: "RullemÃ¥ler", r_p: "Beregn", r_d1: "Diameter (D)", r_d2: "Kjerne (d)", r_s: "Tykkelse", res_l: "LENGDE", n_h: "Optimering", n_p: "Layouts", n_pb: "Plate B", n_ph: "Plate H", n_cut: "SkjÃ¦rebredde", n_sb: "Skilt B", n_sh: "Skilt H", eff: "Effektivitet", l_h: "LED Pro", l_p: "Plan", l_z: "Dybde", l_res: "AVSTAND", l_qty: "Moduler", l_psu: "StrÃ¸m", hist: "Historikk", hist_p: "Prosjekter", proj: "Prosjekt", proj_p: "Kunde...", save_btn: "Lagre", list_btn: "Liste", clear_hist: "Slett", imp: "Juridisk", priv: "Personvern" },
        ja: { mainH: "çœ‹æ¿ãƒ„ãƒ¼ãƒ«", back: "æˆ»ã‚‹", bt: "BTæŽ¥ç¶š", r_h: "ãƒ­ãƒ¼ãƒ«ãƒ¡ãƒ¼ã‚¿ãƒ¼", r_p: "è¨ˆç®—", r_d1: "ç›´å¾„ (D)", r_d2: "èŠ¯ (d)", r_s: "åŽšã¿", res_l: "é•·ã•", n_h: "æœ€é©åŒ–", n_p: "é…ç½®", n_pb: "å¹…", n_ph: "é«˜ã•", n_cut: "ã‚«ãƒƒãƒˆå¹…", n_sb: "å¹… B", n_sh: "é«˜ã• H", eff: "åŠ¹çŽ‡", l_h: "LEDãƒ—ãƒ­", l_p: "è¨ˆç”»", l_z: "æ·±ã•", l_res: "é–“éš”", l_qty: "ãƒ¢ã‚¸ãƒ¥ãƒ¼ãƒ«", l_psu: "é›»æº", hist: "å±¥æ­´", hist_p: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆ", proj: "ãƒ—ãƒ­ã‚¸ã‚§ã‚¯ãƒˆå", proj_p: "é¡§å®¢...", save_btn: "ä¿å­˜", list_btn: "ãƒªã‚¹ãƒˆ", clear_hist: "å‰Šé™¤", imp: "ä¼šç¤¾æ¦‚è¦", priv: "ãƒ—ãƒ©ã‚¤ãƒã‚·ãƒ¼" }
    };

    function getT(l, k) { return (i18n[l] && i18n[l][k]) ? i18n[l][k] : (i18n['en'][k] || k); }

    function changeLang() {
        const l = document.getElementById('lG').value;
        document.querySelectorAll('[data-t]').forEach(el => { el.innerText = getT(l, el.getAttribute('data-t')); });
        document.querySelectorAll('[data-p]').forEach(el => { el.placeholder = getT(l, el.getAttribute('data-p')); });
        updateFooterLinks(l);
        calcN(); calcR(); calcL();
    }

    function updateFooterLinks(l) {
        document.getElementById('footer-content').innerHTML = `<strong>GRÃ–NER-SCHULZE GMBH</strong>V2.2.6 | 30.01.2026<br><div class="footer-links"><a href="https://www.groener-schulze.com/impressum" target="_blank">${getT(l,'imp')}</a> | <a href="https://www.groener-schulze.com/datenschutzbestimmungen" target="_blank">${getT(l,'priv')}</a></div>`;
    }

    /* TOOLS LOGIC */
    function calcR() {
        let D = parseFloat(document.getElementById('rD').value), d = parseFloat(document.getElementById('rd').value), s = parseFloat(document.getElementById('rs').value);
        if(D && d && s) document.getElementById('resR').innerText = ((Math.PI * (Math.pow(D,2)-Math.pow(d,2)))/(4000*s)).toFixed(2) + " m";
    }

    function calcN() {
        let pW = parseFloat(document.getElementById('pW').value), pH = parseFloat(document.getElementById('pH').value), sW = parseFloat(document.getElementById('sW').value), sH = parseFloat(document.getElementById('sH').value), gap = parseFloat(document.getElementById('cut').value) || 0;
        if(pW && pH && sW && sH) {
            let n1 = Math.floor((pW+gap)/(sW+gap)) * Math.floor((pH+gap)/(sH+gap)), n2 = Math.floor((pW+gap)/(sH+gap)) * Math.floor((pH+gap)/(sW+gap));
            let total = Math.max(n1, n2);
            document.getElementById('resN').innerText = total;
            document.getElementById('resE').innerText = getT(document.getElementById('lG').value, 'eff') + ": " + (((total*sW*sH)/(pW*pH))*100).toFixed(1) + "%";
        }
    }

    const modules = { gs_eco: { name: "GS-Eco 0.72W", a: 160, w: 0.72 }, gs_pow: { name: "GS-Power 1.20W", a: 170, w: 1.2 }, amz_std: { name: "AMZ Std 0.72W", a: 120, w: 0.72 }, amz_inj: { name: "AMZ Inj 1.50W", a: 160, w: 1.5 } };
    const psuDatabase = [{ name: "GS-LPV-60", p: 60 }, { name: "GS-HLG-150", p: 150 }, { name: "AMZ-120W", p: 120 }];

    function calcL() {
        let kw = parseFloat(document.getElementById('lkw').value), kh = parseFloat(document.getElementById('lkh').value), z = parseFloat(document.getElementById('lz').value), sel = document.getElementById('lSelect').value;
        let mod = modules[sel], dist = (2 * z * Math.tan((mod.a/2) * (Math.PI/180)) * 0.6);
        document.getElementById('resL').innerText = dist.toFixed(1) + " mm";
        if(kw && kh && dist > 0) {
            let q = Math.ceil(kw/dist) * Math.ceil(kh/dist);
            document.getElementById('outQty').innerText = q;
            let psu = psuDatabase.find(p => p.p >= (q * mod.w * 1.2));
            document.getElementById('outPSU').innerText = psu ? psu.name : "Split!";
        }
    }

    function saveToHistory() {
        let h = JSON.parse(localStorage.getItem('gs_h6') || '[]');
        h.unshift({ n: document.getElementById('projName').value || "Project", d: new Date().toLocaleDateString(), q: document.getElementById('outQty').innerText, m: modules[document.getElementById('lSelect').value].name });
        localStorage.setItem('gs_h6', JSON.stringify(h.slice(0, 10))); alert("Saved!");
    }
    function showHistory() {
        let h = JSON.parse(localStorage.getItem('gs_h6') || '[]');
        document.getElementById('hist-list').innerHTML = h.map(i => `<div class="hist-item"><strong>${i.n}</strong> (${i.d})<br>${i.q}x ${i.m}</div>`).join('');
        go('historie');
    }
    function clearHistory() { localStorage.removeItem('gs_h6'); showHistory(); }
    function applyModule() { calcL(); }
    function go(v) { document.querySelectorAll('.view').forEach(e => e.classList.remove('active')); document.getElementById(v === 'main' ? 'main' : 'view-' + v).classList.add('active'); lucide.createIcons(); }
    function shareWhatsApp() { 
        let text = `*PROJEKT:* ${document.getElementById('projName').value}\nðŸ“¦ ${document.getElementById('outQty').innerText}x ${modules[document.getElementById('lSelect').value].name}`;
        window.open(`https://wa.me/?text=${encodeURIComponent(text)}`, '_blank');
    }
    function showList() {
        let mod = modules[document.getElementById('lSelect').value];
        document.getElementById('order-content').innerHTML = `<strong>${document.getElementById('projName').value}</strong><hr>${document.getElementById('outQty').innerText}x ${mod.name}<br>${document.getElementById('outPSU').innerText}`;
        go('liste');
    }

    function initApp() {
        const browserLang = navigator.language.split('-')[0];
        document.getElementById('lG').value = i18n[browserLang] ? browserLang : 'en';
        changeLang(); lucide.createIcons();
    }

    let clks = 0, tmr;
    document.getElementById('logo-trigger').addEventListener('click', () => {
        clks++; clearTimeout(tmr);
        if (clks === 5) { document.getElementById('egg-popup').style.display='flex'; setTimeout(()=>document.getElementById('egg-popup').style.display='none',3000); clks=0; }
        tmr = setTimeout(()=>clks=0, 1000);
    });

    initApp();
</script>
</body>
</html>
